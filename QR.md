# QR Factorization Program
### David Huangal

## Code:

```matlab
function [Q,R] = qrfact(A)

% Get the size of the matrix
n = size(A,1);

% Initially set Q to the nxn identity matrix
Q=eye(n);
% Initially set R to A
R=A;


for i=1:n-1

  % Set x to the particular section of A
  x=R(i:n,i);

  u=-sign(x(1))*norm(x)*eye(n-i+1,1)-x;

  if norm(u) > 0
    u=u/norm(u);
    Qt=eye(n);

    % Perform I - 2*u*u'
    Qt(i:n,i:n) = Qt(i:n,i:n)-2*u*u';

    % Move R slightly closer to upper triangular
    R=Qt*R;

    % Update the larger Q matrix
    Q=Q*Qt;
  endif

endfor
endfunction

```

## Example Usage:

```matlab

A = rand(5)

A =

   0.137725   0.115187   0.829016   0.621535   0.854243
   0.075896   0.690650   0.469981   0.556246   0.522995
   0.152092   0.764647   0.395708   0.874381   0.900087
   0.963599   0.434992   0.719173   0.542620   0.748389
   0.777580   0.641461   0.333643   0.646823   0.693835


[Q, R] = qrfact(A)

Q =

  -0.109533  -0.020104   0.907990   0.301000   0.269353
  -0.060361  -0.669697   0.133365  -0.686353   0.242892
  -0.120959  -0.691605  -0.044058   0.497168  -0.507872
  -0.766352   0.248857   0.158434  -0.313410  -0.476914
  -0.618411  -0.104188  -0.361559   0.304821   0.618928

R =

  -1.25738  -0.87684  -0.92451  -1.02326  -1.23661
  -0.00000  -0.95226  -0.46088  -0.92209  -0.87597
   0.00000   0.00000   0.79129   0.45211   0.67345
   0.00000  -0.00000   0.00000   0.26712   0.32261
   0.00000   0.00000  -0.00000   0.00000  -0.02749

% Visually, it can be seen that R is upper triangular


% Show that A - Q*R is close to zero:
A - Q*R

ans =

  -7.7716e-16  -5.2736e-16  -8.8818e-16  -8.8818e-16  -9.9920e-16
  -4.1633e-17  -5.5511e-16   5.5511e-17  -2.2204e-16  -1.1102e-16
  -5.5511e-17  -3.3307e-16  -3.3307e-16  -3.3307e-16  -4.4409e-16
  -5.5511e-16  -5.5511e-17  -5.5511e-16  -2.2204e-16  -5.5511e-16
  -4.4409e-16  -2.2204e-16  -3.8858e-16  -4.4409e-16  -5.5511e-16


% Show that Q is orthogonal

Q*Q'

ans =

   1.0000e+00  -2.9805e-16   2.4263e-16   2.8456e-16   4.4409e-16
  -2.9805e-16   1.0000e+00   2.9265e-16  -2.4863e-17  -2.7756e-17
   2.4263e-16   2.9265e-16   1.0000e+00  -5.5535e-17   5.5511e-17
   2.8456e-16  -2.4863e-17  -5.5535e-17   1.0000e+00   5.5511e-17
   4.4409e-16  -2.7756e-17   5.5511e-17   5.5511e-17   1.0000e+00

```
